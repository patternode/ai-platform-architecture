<mxfile host="app.diagrams.net" modified="2025-11-28T00:00:00.000Z" agent="GitHub Copilot" version="22.1.0" etag="SBB-APP-001-DataFlow" type="device">
  <diagram id="SBB-APP-001-DataFlow" name="AWS AgentCore Data Flow">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="SBB-APP-001: AWS Bedrock AgentCore - Data Flow Implementation" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="350" y="30" width="700" height="30" as="geometry" />
        </mxCell>
        
        <!-- Actors -->
        <mxCell id="user" value="&lt;b&gt;User&lt;/b&gt;" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;fillColor=#FFE6CC;strokeColor=#D79B00;" vertex="1" parent="1">
          <mxGeometry x="80" y="150" width="40" height="80" as="geometry" />
        </mxCell>
        
        <!-- Lifelines -->
        <mxCell id="api-gateway-box" value="&lt;b&gt;API Gateway&lt;/b&gt;&lt;br&gt;Regional Endpoint" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DAE8FC;strokeColor=#6C8EBF;" vertex="1" parent="1">
          <mxGeometry x="200" y="150" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="api-gateway-line" value="" style="endArrow=none;dashed=1;html=1;strokeWidth=2;strokeColor=#6C8EBF;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="260" y="810" as="sourcePoint" />
            <mxPoint x="260" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="runtime-box" value="&lt;b&gt;AgentCore Runtime&lt;/b&gt;&lt;br&gt;Firecracker microVM" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF2CC;strokeColor=#D6B656;" vertex="1" parent="1">
          <mxGeometry x="380" y="150" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="runtime-line" value="" style="endArrow=none;dashed=1;html=1;strokeWidth=2;strokeColor=#D6B656;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="440" y="810" as="sourcePoint" />
            <mxPoint x="440" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="memory-box" value="&lt;b&gt;AgentCore Memory&lt;/b&gt;&lt;br&gt;DynamoDB + In-Memory" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1D5E7;strokeColor=#9673A6;" vertex="1" parent="1">
          <mxGeometry x="560" y="150" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="memory-line" value="" style="endArrow=none;dashed=1;html=1;strokeWidth=2;strokeColor=#9673A6;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="620" y="810" as="sourcePoint" />
            <mxPoint x="620" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="bedrock-box" value="&lt;b&gt;Amazon Bedrock&lt;/b&gt;&lt;br&gt;Foundation Model API" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#82B366;" vertex="1" parent="1">
          <mxGeometry x="740" y="150" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bedrock-line" value="" style="endArrow=none;dashed=1;html=1;strokeWidth=2;strokeColor=#82B366;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="810" as="sourcePoint" />
            <mxPoint x="800" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="gateway-box" value="&lt;b&gt;AgentCore Gateway&lt;/b&gt;&lt;br&gt;MCP Tool Router" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE6CC;strokeColor=#D79B00;" vertex="1" parent="1">
          <mxGeometry x="920" y="150" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gateway-line" value="" style="endArrow=none;dashed=1;html=1;strokeWidth=2;strokeColor=#D79B00;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="980" y="810" as="sourcePoint" />
            <mxPoint x="980" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="external-box" value="&lt;b&gt;External API&lt;/b&gt;&lt;br&gt;(e.g. Salesforce)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8CECC;strokeColor=#B85450;" vertex="1" parent="1">
          <mxGeometry x="1100" y="150" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="external-line" value="" style="endArrow=none;dashed=1;html=1;strokeWidth=2;strokeColor=#B85450;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1160" y="810" as="sourcePoint" />
            <mxPoint x="1160" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="observability-box" value="&lt;b&gt;Observability&lt;/b&gt;&lt;br&gt;CloudWatch / X-Ray" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8EAF6;strokeColor=#5E35B1;" vertex="1" parent="1">
          <mxGeometry x="1280" y="150" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="observability-line" value="" style="endArrow=none;dashed=1;html=1;strokeWidth=2;strokeColor=#5E35B1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1340" y="810" as="sourcePoint" />
            <mxPoint x="1340" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Sequence Flows -->
        
        <!-- 1. User Request -->
        <mxCell id="flow-1" value="1: POST /agents/{id}/invoke&lt;br&gt;{query, context}" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#0066CC;fontSize=10;" edge="1" parent="1" source="user" target="api-gateway-line">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="120" y="250" as="sourcePoint" />
            <mxPoint x="260" y="250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- 2. Authenticate -->
        <mxCell id="flow-2" value="2: Authenticate (IAM)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#0066CC;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="260" y="280" as="sourcePoint" />
            <mxPoint x="260" y="300" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- 3. Route to Runtime -->
        <mxCell id="flow-3" value="3: Route request&lt;br&gt;(HTTPS + JWT)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#0066CC;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="260" y="320" as="sourcePoint" />
            <mxPoint x="440" y="320" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- 4. Load Context -->
        <mxCell id="flow-4" value="4: Load conversation&lt;br&gt;context" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#0066CC;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="440" y="350" as="sourcePoint" />
            <mxPoint x="620" y="350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow-4-resp" value="5: Return context&lt;br&gt;+ memory" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#9673A6;dashed=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="620" y="380" as="sourcePoint" />
            <mxPoint x="440" y="380" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- 6. Foundation Model Inference -->
        <mxCell id="flow-6" value="6: InvokeModel&lt;br&gt;(AWS SDK, JSON)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#0066CC;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="440" y="410" as="sourcePoint" />
            <mxPoint x="800" y="410" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow-6-resp" value="7: Model response&lt;br&gt;+ tool calls" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#82B366;dashed=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="800" y="440" as="sourcePoint" />
            <mxPoint x="440" y="440" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- 8. Tool Invocation -->
        <mxCell id="flow-8" value="8: Invoke tool&lt;br&gt;(MCP over HTTPS)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#0066CC;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="440" y="470" as="sourcePoint" />
            <mxPoint x="980" y="470" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow-9" value="9: Forward to API&lt;br&gt;(REST/gRPC)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#0066CC;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="980" y="500" as="sourcePoint" />
            <mxPoint x="1160" y="500" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow-9-resp" value="10: API response" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#B85450;dashed=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1160" y="530" as="sourcePoint" />
            <mxPoint x="980" y="530" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow-10-resp" value="11: Tool result" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#D79B00;dashed=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="980" y="560" as="sourcePoint" />
            <mxPoint x="440" y="560" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- 12. Second Model Call (with tool results) -->
        <mxCell id="flow-12" value="12: InvokeModel&lt;br&gt;(with tool results)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#0066CC;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="440" y="590" as="sourcePoint" />
            <mxPoint x="800" y="590" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow-12-resp" value="13: Final response" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#82B366;dashed=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="800" y="620" as="sourcePoint" />
            <mxPoint x="440" y="620" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- 14. Store Memory -->
        <mxCell id="flow-14" value="14: Store updated&lt;br&gt;context" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#0066CC;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="440" y="650" as="sourcePoint" />
            <mxPoint x="620" y="650" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow-14-resp" value="15: ACK" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#9673A6;dashed=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="620" y="670" as="sourcePoint" />
            <mxPoint x="440" y="670" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- 16. Return to User -->
        <mxCell id="flow-16" value="16: Forward response&lt;br&gt;(JSON)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#0066CC;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="440" y="700" as="sourcePoint" />
            <mxPoint x="260" y="700" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow-17" value="17: 200 OK&lt;br&gt;{response}" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#0066CC;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="260" y="730" as="sourcePoint" />
            <mxPoint x="120" y="730" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- 18. Telemetry (async) -->
        <mxCell id="flow-telemetry" value="18: Emit telemetry&lt;br&gt;(async, OpenTelemetry)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#5E35B1;dashed=1;dashPattern=5 5;fontSize=10;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="440" y="770" as="sourcePoint" />
            <mxPoint x="1340" y="770" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Legend -->
        <mxCell id="legend-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#F5F5F5;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="80" y="830" width="1320" height="80" as="geometry" />
        </mxCell>
        <mxCell id="legend-title" value="&lt;b&gt;Legend&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="100" y="840" width="200" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-request" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#0066CC;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="100" y="872.5" as="sourcePoint" />
            <mxPoint x="140" y="872.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="legend-request-text" value="Synchronous Request" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="145" y="860" width="140" height="25" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-response" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#82B366;dashed=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="300" y="872.5" as="sourcePoint" />
            <mxPoint x="340" y="872.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="legend-response-text" value="Synchronous Response" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="345" y="860" width="150" height="25" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-async" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#5E35B1;dashed=1;dashPattern=5 5;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="510" y="872.5" as="sourcePoint" />
            <mxPoint x="550" y="872.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="legend-async-text" value="Asynchronous (Telemetry)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="555" y="860" width="170" height="25" as="geometry" />
        </mxCell>
        
        <!-- Summary Stats -->
        <mxCell id="stats-title" value="&lt;b&gt;Sequence Summary:&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="750" y="842" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="stats-content" value="18 steps | 2 model invocations | 1 tool call | Protocols: HTTPS, AWS SDK, MCP, REST/gRPC | Observability: OpenTelemetry â†’ CloudWatch/X-Ray" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="750" y="862" width="630" height="40" as="geometry" />
        </mxCell>
        
        <!-- Notation -->
        <mxCell id="notation" value="Notation: UML 2.5 Sequence Diagram | SBB-APP-001 v1.0.0 | BNZ Enterprise Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=right;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="900" y="920" width="500" height="20" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
