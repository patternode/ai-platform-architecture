<mxfile host="65bd71144e">
    <diagram name="Copilot Studio Infrastructure" id="copilot-studio-infra">
        <mxGraphModel dx="1338" dy="742" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="title" value="Microsoft Copilot Studio - BNZ Enterprise Infrastructure" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1" parent="1" vertex="1">
                    <mxGeometry x="400" y="20" width="800" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="azure-cloud" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E6F3FF;strokeColor=#0078D4;strokeWidth=3;dashed=1;dashPattern=8 8;arcSize=2;" parent="1" vertex="1">
                    <mxGeometry x="40" y="80" width="1520" height="1080" as="geometry"/>
                </mxCell>
                <mxCell id="azure-label" value="Microsoft Azure - New Zealand Region" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#0078D4;" parent="1" vertex="1">
                    <mxGeometry x="60" y="90" width="400" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="tenant-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF4E6;strokeColor=#D83B01;strokeWidth=2;arcSize=3;" parent="1" vertex="1">
                    <mxGeometry x="80" y="140" width="1440" height="980" as="geometry"/>
                </mxCell>
                <mxCell id="tenant-label" value="BNZ Microsoft 365 Tenant" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#D83B01;" parent="1" vertex="1">
                    <mxGeometry x="100" y="150" width="300" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="azure-ad" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/identity/Azure_Active_Directory.svg;" parent="1" vertex="1">
                    <mxGeometry x="140" y="200" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="azure-ad-label" value="Azure AD / Entra ID&#xa;• MFA Enabled&#xa;• Conditional Access&#xa;• Certificate Auth" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
                    <mxGeometry x="220" y="205" width="180" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="purview" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/analytics/Azure_Purview_Accounts.svg;" parent="1" vertex="1">
                    <mxGeometry x="140" y="290" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="purview-label" value="Microsoft Purview&#xa;• Maker Audit Logs&#xa;• Sensitivity Labels&#xa;• DLP Policies" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
                    <mxGeometry x="220" y="295" width="180" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="sentinel" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/security/Azure_Sentinel.svg;" parent="1" vertex="1">
                    <mxGeometry x="140" y="380" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="sentinel-label" value="Microsoft Sentinel&#xa;• Agent Activity Monitoring&#xa;• Security Alerts&#xa;• SIEM Integration" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
                    <mxGeometry x="220" y="385" width="180" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="app-insights" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/monitor/Application_Insights.svg;" parent="1" vertex="1">
                    <mxGeometry x="140" y="470" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="app-insights-label" value="Application Insights&#xa;• Telemetry Streaming&#xa;• Performance Monitoring&#xa;• Custom Dashboards" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
                    <mxGeometry x="220" y="475" width="180" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="key-vault" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/security/Key_Vaults.svg;" parent="1" vertex="1">
                    <mxGeometry x="140" y="560" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="key-vault-label" value="Azure Key Vault&#xa;• Customer-Managed Keys&#xa;• Certificate Storage&#xa;• Secrets Management" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
                    <mxGeometry x="220" y="565" width="180" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="pp-admin" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/other/Power_Platform.svg;" parent="1" vertex="1">
                    <mxGeometry x="1380" y="200" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="pp-admin-label" value="Power Platform&#xa;Admin Center&#xa;• Governance&#xa;• DLP Enforcement&#xa;• Capacity Monitoring" style="text;html=1;strokeColor=none;fillColor=none;align=right;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
                    <mxGeometry x="1180" y="200" width="180" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="dev-env" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E9;strokeColor=#2E7D32;strokeWidth=2;" parent="1" vertex="1">
                    <mxGeometry x="460" y="220" width="320" height="280" as="geometry"/>
                </mxCell>
                <mxCell id="dev-label" value="DEV Environment (New Zealand)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#2E7D32;" parent="1" vertex="1">
                    <mxGeometry x="470" y="230" width="300" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="dev-copilot" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/ai_machine_learning/Bot_Services.svg;" parent="1" vertex="1">
                    <mxGeometry x="490" y="270" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="dev-copilot-label" value="Copilot Studio&#xa;• Agent Development&#xa;• Testing Canvas" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="570" y="280" width="140" height="45" as="geometry"/>
                </mxCell>
                <mxCell id="dev-dataverse" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/databases/Azure_Database_PostgreSQL_Server.svg;" parent="1" vertex="1">
                    <mxGeometry x="490" y="350" width="48" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="dev-dataverse-label" value="Dataverse&#xa;• Agent Config&#xa;• Dev Data" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="560" y="360" width="140" height="45" as="geometry"/>
                </mxCell>
                <mxCell id="dev-dlp" value="DLP: Relaxed&#xa;Dev tools allowed" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF9C4;strokeColor=#F57F17;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="490" y="430" width="260" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="test-env" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF3E0;strokeColor=#E65100;strokeWidth=2;" parent="1" vertex="1">
                    <mxGeometry x="840" y="220" width="320" height="280" as="geometry"/>
                </mxCell>
                <mxCell id="test-label" value="TEST Environment (New Zealand)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#E65100;" parent="1" vertex="1">
                    <mxGeometry x="850" y="230" width="300" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="test-copilot" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/ai_machine_learning/Bot_Services.svg;" parent="1" vertex="1">
                    <mxGeometry x="870" y="270" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="test-copilot-label" value="Copilot Studio&#xa;• UAT Agents&#xa;• Integration Testing" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="950" y="280" width="140" height="45" as="geometry"/>
                </mxCell>
                <mxCell id="test-dataverse" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/databases/Azure_Database_PostgreSQL_Server.svg;" parent="1" vertex="1">
                    <mxGeometry x="870" y="350" width="48" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="test-dataverse-label" value="Dataverse&#xa;• Agent Config&#xa;• Test Data" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="940" y="360" width="140" height="45" as="geometry"/>
                </mxCell>
                <mxCell id="test-dlp" value="DLP: Moderate&#xa;Production-like constraints" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE0B2;strokeColor=#E65100;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="870" y="430" width="260" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="prod-env" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFEBEE;strokeColor=#C62828;strokeWidth=3;" parent="1" vertex="1">
                    <mxGeometry x="460" y="560" width="700" height="520" as="geometry"/>
                </mxCell>
                <mxCell id="prod-label" value="PROD Environment (New Zealand) - MANAGED ENVIRONMENT" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#C62828;" parent="1" vertex="1">
                    <mxGeometry x="470" y="570" width="680" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="prod-copilot" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/ai_machine_learning/Bot_Services.svg;" parent="1" vertex="1">
                    <mxGeometry x="490" y="620" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="prod-copilot-label" value="Copilot Studio&#xa;• Production Agents&#xa;• Live Conversations" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="570" y="630" width="140" height="45" as="geometry"/>
                </mxCell>
                <mxCell id="prod-dataverse" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/databases/Azure_Database_PostgreSQL_Server.svg;" parent="1" vertex="1">
                    <mxGeometry x="490" y="710" width="48" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="prod-dataverse-label" value="Dataverse&#xa;• Agent Definitions&#xa;• Conversation History&#xa;• Production Data" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="560" y="715" width="140" height="55" as="geometry"/>
                </mxCell>
                <mxCell id="prod-openai" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/ai_machine_learning/Azure_OpenAI.svg;" parent="1" vertex="1">
                    <mxGeometry x="780" y="620" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="prod-openai-label" value="Azure OpenAI Service&#xa;• GPT Models&#xa;• Generative Answers&#xa;• RAG Processing" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="860" y="625" width="140" height="55" as="geometry"/>
                </mxCell>
                <mxCell id="prod-search" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/ai_machine_learning/Cognitive_Search.svg;" parent="1" vertex="1">
                    <mxGeometry x="780" y="710" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="prod-search-label" value="Azure Cognitive Search&#xa;• Knowledge Indexing&#xa;• Semantic Search&#xa;• Vector Storage" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="860" y="715" width="140" height="55" as="geometry"/>
                </mxCell>
                <mxCell id="prod-sharepoint" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/other/SharePoint.svg;" parent="1" vertex="1">
                    <mxGeometry x="490" y="800" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="prod-sharepoint-label" value="SharePoint Online&#xa;• Knowledge Sources&#xa;• Documents&#xa;• Security Trimming" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="570" y="805" width="140" height="55" as="geometry"/>
                </mxCell>
                <mxCell id="prod-flow" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/other/Power_Automate.svg;" parent="1" vertex="1">
                    <mxGeometry x="780" y="800" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="prod-flow-label" value="Agent Flows&#xa;• Automations&#xa;• Tools/Actions&#xa;• Integrations" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="860" y="805" width="140" height="55" as="geometry"/>
                </mxCell>
                <mxCell id="prod-dlp" value="DLP: STRICT - Only Approved Connectors" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCDD2;strokeColor=#C62828;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="490" y="890" width="510" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="prod-security" value="PRODUCTION SECURITY CONTROLS&#xa;• Azure AD with MFA&#xa;• Certificate-based Auth&#xa;• Run Tools with User Credentials&#xa;• Agent Runtime Protection Status&#xa;• Automatic Security Scan&#xa;• Environment Routing&#xa;• Customer Lockbox&#xa;• Audit Logging to Purview &amp; Sentinel" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1565C0;fontSize=10;align=left;verticalAlign=top;" parent="1" vertex="1">
                    <mxGeometry x="490" y="950" width="510" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="channels-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#6A1B9A;strokeWidth=2;dashed=1;" parent="1" vertex="1">
                    <mxGeometry x="1220" y="560" width="280" height="520" as="geometry"/>
                </mxCell>
                <mxCell id="channels-label" value="Deployment Channels" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#6A1B9A;" parent="1" vertex="1">
                    <mxGeometry x="1230" y="570" width="260" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="channel-teams" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/other/Microsoft_Teams.svg;" parent="1" vertex="1">
                    <mxGeometry x="1250" y="620" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="channel-teams-label" value="Microsoft Teams&#xa;Internal Employees" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="1330" y="635" width="140" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="channel-m365" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/other/Microsoft_365.svg;" parent="1" vertex="1">
                    <mxGeometry x="1250" y="710" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="channel-m365-label" value="M365 Copilot&#xa;Extensions" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="1330" y="725" width="140" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="channel-web" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/app_services/App_Services.svg;" parent="1" vertex="1">
                    <mxGeometry x="1250" y="800" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="channel-web-label" value="Web Chat Widget&#xa;Public/Internal Sites" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="1330" y="815" width="140" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="channel-mobile" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/general/Mobile.svg;" parent="1" vertex="1">
                    <mxGeometry x="1250" y="890" width="48" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="channel-mobile-label" value="Mobile Apps&#xa;iOS/Android" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="1320" y="905" width="140" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="channel-ivr" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/other/Azure_Communication_Services.svg;" parent="1" vertex="1">
                    <mxGeometry x="1250" y="980" width="64" height="64" as="geometry"/>
                </mxCell>
                <mxCell id="channel-ivr-label" value="IVR / Voice&#xa;Azure Speech Services" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="1330" y="995" width="140" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="arrow-dev-test" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#558B2F;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="dev-env" target="test-env" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="800" y="400" as="sourcePoint"/>
                        <mxPoint x="850" y="350" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-dev-test-label" value="Solution Export/Import" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#558B2F;fontStyle=1;" parent="arrow-dev-test" vertex="1" connectable="0">
                    <mxGeometry x="-0.1" y="-1" relative="1" as="geometry">
                        <mxPoint x="5" y="-11" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-test-prod" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#D84315;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="test-env" target="prod-env" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="900" y="550" as="sourcePoint"/>
                        <mxPoint x="950" y="500" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-test-prod-label" value="Solution Deployment&#xa;(Approved Only)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#D84315;fontStyle=1;" parent="arrow-test-prod" vertex="1" connectable="0">
                    <mxGeometry x="-0.1" y="-1" relative="1" as="geometry">
                        <mxPoint x="60" y="-5" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-prod-channels" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#6A1B9A;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="prod-env" target="channels-container" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1170" y="850" as="sourcePoint"/>
                        <mxPoint x="1220" y="800" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-prod-channels-label" value="Publish" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#6A1B9A;fontStyle=1;" parent="arrow-prod-channels" vertex="1" connectable="0">
                    <mxGeometry x="-0.1" y="-1" relative="1" as="geometry">
                        <mxPoint y="-11" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-ad-dev" value="" style="endArrow=classic;html=1;strokeWidth=1;strokeColor=#0078D4;dashed=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" parent="1" source="azure-ad" target="dev-env" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="210" y="232" as="sourcePoint"/>
                        <mxPoint x="460" y="290" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-ad-test" value="" style="endArrow=classic;html=1;strokeWidth=1;strokeColor=#0078D4;dashed=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" parent="1" source="azure-ad" target="test-env" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="214" y="242" as="sourcePoint"/>
                        <mxPoint x="470" y="300" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-ad-prod" value="" style="endArrow=classic;html=1;strokeWidth=1;strokeColor=#0078D4;dashed=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" parent="1" source="azure-ad" target="prod-env" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="214" y="242" as="sourcePoint"/>
                        <mxPoint x="850" y="300" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-ad-label" value="Authentication" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#0078D4;" parent="arrow-ad-prod" vertex="1" connectable="0">
                    <mxGeometry x="-0.4" y="-1" relative="1" as="geometry">
                        <mxPoint x="20" y="-9" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-purview-prod" value="" style="endArrow=classic;html=1;strokeWidth=1;strokeColor=#7B1FA2;dashed=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;startArrow=classic;startFill=1;" parent="1" source="purview" target="prod-env" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="214" y="242" as="sourcePoint"/>
                        <mxPoint x="470" y="690" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-purview-label" value="Audit Logs" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#7B1FA2;" parent="arrow-purview-prod" vertex="1" connectable="0">
                    <mxGeometry x="-0.4" y="-1" relative="1" as="geometry">
                        <mxPoint x="35" y="-9" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-sentinel-prod" value="" style="endArrow=classic;html=1;strokeWidth=1;strokeColor=#C62828;dashed=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;startArrow=classic;startFill=1;" parent="1" source="sentinel" target="prod-env" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="214" y="332" as="sourcePoint"/>
                        <mxPoint x="470" y="830" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-sentinel-label" value="Activity Monitoring" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#C62828;" parent="arrow-sentinel-prod" vertex="1" connectable="0">
                    <mxGeometry x="-0.4" y="-1" relative="1" as="geometry">
                        <mxPoint x="45" y="-9" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-insights-prod" value="" style="endArrow=classic;html=1;strokeWidth=1;strokeColor=#00897B;dashed=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.9;entryDx=0;entryDy=0;startArrow=classic;startFill=1;" parent="1" source="app-insights" target="prod-env" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="214" y="422" as="sourcePoint"/>
                        <mxPoint x="470" y="958" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-insights-label" value="Telemetry" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#00897B;" parent="arrow-insights-prod" vertex="1" connectable="0">
                    <mxGeometry x="-0.4" y="-1" relative="1" as="geometry">
                        <mxPoint x="40" y="-9" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-kv-prod" value="" style="endArrow=classic;html=1;strokeWidth=1;strokeColor=#E65100;dashed=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.1;entryY=1;entryDx=0;entryDy=0;" parent="1" source="key-vault" target="prod-env" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="214" y="512" as="sourcePoint"/>
                        <mxPoint x="470" y="1028" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-kv-label" value="CMK / Secrets" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#E65100;" parent="arrow-kv-prod" vertex="1" connectable="0">
                    <mxGeometry x="-0.4" y="-1" relative="1" as="geometry">
                        <mxPoint x="30" y="9" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-admin-envs" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#D83B01;dashed=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;startArrow=classic;startFill=1;" parent="1" source="pp-admin" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1360" y="232" as="sourcePoint"/>
                        <mxPoint x="810" y="360" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-admin-label" value="Governance &amp; Monitoring" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#D83B01;fontStyle=1;" parent="arrow-admin-envs" vertex="1" connectable="0">
                    <mxGeometry x="-0.1" y="-1" relative="1" as="geometry">
                        <mxPoint x="-80" y="-11" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="legend-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#424242;strokeWidth=2;" parent="1" vertex="1">
                    <mxGeometry x="100" y="670" width="300" height="180" as="geometry"/>
                </mxCell>
                <mxCell id="legend-title" value="LEGEND" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="110" y="680" width="280" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="legend-dev" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E9;strokeColor=#2E7D32;strokeWidth=2;" parent="1" vertex="1">
                    <mxGeometry x="120" y="710" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="legend-dev-label" value="Development Environment" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="160" y="710" width="220" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="legend-test" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF3E0;strokeColor=#E65100;strokeWidth=2;" parent="1" vertex="1">
                    <mxGeometry x="120" y="740" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="legend-test-label" value="Test Environment" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="160" y="740" width="220" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="legend-prod" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFEBEE;strokeColor=#C62828;strokeWidth=3;" parent="1" vertex="1">
                    <mxGeometry x="120" y="770" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="legend-prod-label" value="Production Environment (Managed)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="160" y="770" width="220" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="legend-solid" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#424242;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="120" y="810" as="sourcePoint"/>
                        <mxPoint x="150" y="810" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="legend-solid-label" value="Deployment Flow" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="160" y="800" width="220" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="legend-dashed" value="" style="endArrow=classic;html=1;strokeWidth=1;strokeColor=#424242;dashed=1;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="120" y="830" as="sourcePoint"/>
                        <mxPoint x="150" y="830" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="legend-dashed-label" value="Integration / Communication" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="160" y="820" width="220" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="doc-info" value="Document: Copilot Studio Infrastructure Diagram&#xa;Organization: Bank of New Zealand (BNZ)&#xa;Region: New Zealand (Australia East Azure Region)&#xa;Created: November 17, 2025&#xa;Classification: INTERNAL USE" style="text;html=1;strokeColor=#616161;fillColor=#F5F5F5;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=9;fontFamily=Courier New;" parent="1" vertex="1">
                    <mxGeometry x="100" y="900" width="300" height="90" as="geometry"/>
                </mxCell>
                <mxCell id="data-residency" value="DATA RESIDENCY COMPLIANCE&#xa;All environments hosted in Azure New Zealand region&#xa;Data stored and processed within NZ boundaries&#xa;Meets local regulatory requirements" style="text;html=1;strokeColor=#1565C0;fillColor=#E3F2FD;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=10;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="100" y="1010" width="300" height="80" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>